import json

with open('sample_sns.txt', 'r') as sns:
  obj = json.loads(sns.read())
  print(json.dumps(obj, indent=2))

d = {"version":"0","id":"b13b568e-1517-2956-2572-7ed2f4745c3a","detail-type":"Inspector2 Finding","source":"aws.inspector2","account":"510570140727","time":"2023-12-14T08:04:44Z","region":"ap-southeast-1","resources":["arn:aws:ecr:ap-southeast-1:510570140727:repository/webportal/frontend/sha256:e71229aef6f01237429d2d5622529b38e1cfad28f3184c006c826aa6c23fbb74"],"detail":{"awsAccountId":"510570140727","description":"## Overview\nmonorepo-symlink-test is a malicious package. \nThis package contains malicious code, and its content was removed from the official package manager. While this package might be attempting to impersonate a valid organization, there is no connection between that organization and this package's authorship.\n\n\n## Remediation\nAvoid using all malicious instances of the `monorepo-symlink-test` package.\n## References\n- [NPM Security Placeholder](https://npmjs.com/package/monorepo-symlink-test)","exploitAvailable":"NO","findingArn":"arn:aws:inspector2:ap-southeast-1:510570140727:finding/0f6c3d62d3b5a315f3db6510d96b65b0","firstObservedAt":"Dec 12, 2023, 10:01:32 AM","fixAvailable":"NO","inspectorScore":9.8,"inspectorScoreDetails":{"adjustedCvss":{"adjustments":[],"cvssSource":"SNYK","score":9.8,"scoreSource":"SNYK","scoringVector":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H","version":"3.1"}},"lastObservedAt":"Dec 14, 2023, 8:04:44 AM","packageVulnerabilityDetails":{"cvss":[{"baseScore":9.8,"scoringVector":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H","source":"SNYK","version":"3.1"}],"referenceUrls":["https://npmjs.com/package/monorepo-symlink-test"],"relatedVulnerabilities":[],"source":"SNYK","sourceUrl":"https://security.snyk.io/vuln/SNYK-JS-MONOREPOSYMLINKTEST-5865510","vendorCreatedAt":"Aug 30, 2023, 6:54:00 AM","vendorSeverity":"critical","vendorUpdatedAt":"Aug 30, 2023, 6:54:00 AM","vulnerabilityId":"SNYK-JS-MONOREPOSYMLINKTEST-5865510","vulnerablePackages":[{"epoch":0,"filePath":"app/node_modules/resolve/test/resolver/multirepo/package.json","fixedInVersion":"NotAvailable","name":"monorepo-symlink-test","packageManager":"NODEPKG","remediation":"NotAvailable","sourceLayerHash":"sha256:b7ea43caed1128dac626b363dbfb9a9a285551afbfa0491a33ce135b102d38bf","version":"0.0.0"},{"epoch":0,"filePath":"app/node_modules/eslint-plugin-react/node_modules/resolve/test/resolver/multirepo/package.json","fixedInVersion":"NotAvailable","name":"monorepo-symlink-test","packageManager":"NODEPKG","remediation":"NotAvailable","sourceLayerHash":"sha256:b7ea43caed1128dac626b363dbfb9a9a285551afbfa0491a33ce135b102d38bf","version":"0.0.0"}]},"remediation":{"recommendation":{"text":"None Provided"}},"resources":[{"details":{"awsEcrContainerImage":{"architecture":"amd64","imageHash":"sha256:e71229aef6f01237429d2d5622529b38e1cfad28f3184c006c826aa6c23fbb74","imageTags":[],"platform":"ALPINE_LINUX_3_17","pushedAt":"Dec 12, 2023, 10:01:09 AM","registry":"510570140727","repositoryName":"webportal/frontend"}},"id":"arn:aws:ecr:ap-southeast-1:510570140727:repository/webportal/frontend/sha256:e71229aef6f01237429d2d5622529b38e1cfad28f3184c006c826aa6c23fbb74","partition":"aws","region":"ap-southeast-1","type":"AWS_ECR_CONTAINER_IMAGE"}],"severity":"CRITICAL","status":"ACTIVE","title":"IN1-JS-MONOREPOSYMLINKTEST-5865510 - monorepo-symlink-test, monorepo-symlink-test","type":"PACKAGE_VULNERABILITY","updatedAt":"Dec 14, 2023, 8:04:44 AM"}}
print(json.dumps(d, indent=2))

def lambda_handler(event, context):
    message = event['Records'][0]['Sns']['Message']
    parsed_message = json.loads(message)
    print(parsed_message['Records'][0]['s3']['bucket']['name'])